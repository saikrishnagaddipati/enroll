
window.relationships = ['employee', 'spouse', 'domestic_partner', 'child_under_26']
function set_benefits () {
    $('#pct_employee').bootstrapSlider('setValue', employee_value = window.relationship_benefits['employee']);
    $('#employee_slide_input').val(employee_value)
    $('#employee_slide_label').html(employee_value + '%')
    $('#pct_spouse').bootstrapSlider('setValue', spouse_value = window.relationship_benefits['spouse']);
    $('#spouse_input').val(spouse_value)
    $('#spouse_label').html(spouse_value + '%')
    $('#pct_domestic_partner').bootstrapSlider('setValue', domestic_value = window.relationship_benefits['domestic_partner']);
    $('#domestic_input').val(domestic_value)
    $('#domestic_label').html(domestic_value + '%')
    $('#pct_child_under_26').bootstrapSlider('setValue', child_value = window.relationship_benefits['child_under_26']);
    $('#child_input').val(child_value)
    $('#child_label').html(child_value + '%')
    $('#dental_pct_employee').bootstrapSlider('setValue',window.relationship_benefits['employee']);
    $('#dental_pct_spouse').bootstrapSlider('setValue', window.relationship_benefits['spouse']);
    $('#dental_pct_domestic_partner').bootstrapSlider('setValue', window.relationship_benefits['domestic_partner']);
    $('#dental_pct_child_under_26').bootstrapSlider('setValue', window.relationship_benefits['child_under_26']);
}


function set_relationship_pct(relationship, val) {
  window.relationship_benefits[relationship] = val
  $("[name~='" + relationship + "']").val(val)
  $.ajax({
    type: 'POST',
    data: {benefits: window.relationship_benefits, id: $('#quote option:selected').val() },
    url: '/broker_agencies/quotes/update_benefits.js',
  })
  set_plan_costs()
}

$(document).on('keyup', 'input', function() {
  if($(this).val() > 100) {
    if($(this).attr('id') == 'ex1_input') {
      if($(this).val() > 6000) {
        $(this).val(6000);
      }
    }
    else {
      $(this).val(100);
    }
  }
  if ( $(this).hasClass('slider_input') )  {
    var hidden = parseInt($(this).val());
    if(isNaN(hidden)) {
      hidden = 0;
    }
    if ( $(this).hasClass('right_slider_input') ) {
      var mySlider = $(this).closest('div.row').find('input.slider').eq(1);
      mySlider.bootstrapSlider('setValue', hidden);
      mySlider.attr('value', hidden).attr('data-slider-value', hidden);
      $(this).closest('div.row').find('.slide-label').eq(1).text(hidden + "%");
    }
    else {
      var mySlider = $(this).closest('div.row').find('input.slider').eq(0);
      mySlider.bootstrapSlider('setValue', hidden);
      mySlider.attr('value', hidden).attr('data-slider-value', hidden);
      if($(this).attr('id') == 'ex1_input') {
        $(this).closest('div.row').find('.slide-label').eq(0).text("$" + hidden);
      }
      else {
        $(this).closest('div.row').find('.slide-label').eq(0).text(hidden + "%");
      }
    }
  }
});

$(document).on('change', 'input', function(){
  if ( $(this).hasClass('slider') ) {
    var data = $(this).val();
    if ( $(this).hasClass('right-slider') ) {
      $(this).on("slideStop", function(slideEvt) {
        $(this).closest('div.row').find('.slider_input').eq(1).val(data);
        $(this).closest('div.row').find('.slide-label').eq(1).text(data + "%");
      });
    }
    else {
      $(this).on("slideStop", function(slideEvt) {
        $(this).closest('div.row').find('input').eq(0).val(data);
        if($(this).attr('id') == 'ex1') {
          $(this).closest('div.row').find('.slide-label').eq(0).text("$" + data);
        }
        else {
          $(this).closest('div.row').find('.slide-label').eq(0).text(data + "%");
        }
      });
    }
  }
});

function slider_listeners () {
    $('#ex1').bootstrapSlider({});
    $('#ex2').bootstrapSlider({});
    $('#total_plan_cost').bootstrapSlider({
      formatter: function(value) {
        return 'Contribution Percentage: ' + value + '%';
      }
    });
    $('#pct_employee').bootstrapSlider({
      formatter: function(value) {
        return 'Contribution Percentage: ' + value + '%';
      }
    });
    $('#pct_spouse').bootstrapSlider({
      formatter: function(value) {
        return 'Contribution Percentage: ' + value + '%';
      }
    });
    $('#pct_domestic_partner').bootstrapSlider({
      formatter: function(value) {
        return 'Contribution Percentage: ' + value + '%';
      }
    });
    $('#pct_child_under_26').bootstrapSlider({
      formatter: function(value) {
        return 'Contribution Percentage: ' + value + '%';
      }
    });
    $('#dental_pct_employee').bootstrapSlider({
      formatter: function(value) {
        return 'Contribution Percentage: ' + value + '%';
      }
    });
    $('#dental_pct_spouse').bootstrapSlider({
      formatter: function(value) {
        return 'Contribution Percentage: ' + value + '%';
      }
    });
    $('#dental_pct_domestic_partner').bootstrapSlider({
      formatter: function(value) {
        return 'Contribution Percentage: ' + value + '%';
      }
    });
    $('#dental_pct_child_under_26').bootstrapSlider({
      formatter: function(value) {
        return 'Contribution Percentage: ' + value + '%';
      }
    });
    $('#dental_pctemployees_on_roster').bootstrapSlider({
      formatter: function(value) {
        return 'Contribution Percentage: ' + value + '%';
      }
    });
    
    
    $('#ex1').on('slideStop', function(){deductible_value = this.value;
      toggle_plans([]);
      reset_selected_plans();
    })
    $('#ex2').on('slideStop', function(){deductible_value = this.value;
      toggle_plans([]);
      reset_selected_plans();
    })
    $('#pct_employee').on('slideStop', function() {
        val =$('#pct_employee').bootstrapSlider('getValue')
        set_relationship_pct('employee', val)
       })
    $('#employee_slide_input').on('keyup', function() {
      setTimeout(function () {
        val =$('#pct_employee').bootstrapSlider('getValue')
        set_relationship_pct('employee', val)
      }, 700);
    });
    $('#pct_spouse').on('slideStop', function() {
          val =$('#pct_spouse').bootstrapSlider('getValue')
          set_relationship_pct('spouse', val)
         })
   $('#spouse_input').on('keyup', function() {
     setTimeout(function () {
       val =$('#pct_spouse').bootstrapSlider('getValue')
       set_relationship_pct('spouse', val)
     }, 700);
   });
    $('#pct_domestic_partner').on('slideStop', function() {
          val =$('#pct_domestic_partner').bootstrapSlider('getValue')
          set_relationship_pct('domestic_partner', val)
         })
   $('#domestic_input').on('keyup', function() {
     setTimeout(function () {
       val =$('#pct_domestic_partner').bootstrapSlider('getValue')
       set_relationship_pct('domestic_partner', val)
     }, 700);
   });
    $('#pct_child_under_26').on('slideStop', function() {
          val =$('#pct_child_under_26').bootstrapSlider('getValue')
          set_relationship_pct('child_under_26', val)
         })
   $('#child_input').on('keyup', function() {
     setTimeout(function () {
       val =$('#pct_child_under_26').bootstrapSlider('getValue')
       set_relationship_pct('child_under_26', val)
     }, 700);
   });
    $('#employees_on_roster').on('slideStop', function(){
       $('#employee_count').val($('#employees_on_roster').bootstrapSlider('getValue'))
    })
  set_benefits()
}